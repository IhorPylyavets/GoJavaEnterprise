CREATE TABLE POSITIONS (
	ID SERIAL PRIMARY KEY,
	POSITION_TITLE TEXT NOT NULL
);

CREATE TABLE EMPLOYEES (
	ID SERIAL PRIMARY KEY,
	LAST_NAME TEXT NOT NULL,
	FIRST_NAME TEXT NOT NULL,
	BIRTHDAY TEXT,
	PHONE TEXT,
	POSITION_ID int NOT NULL,
	SALARY real
);
ALTER TABLE EMPLOYEES ADD CONSTRAINT POSITION_ID_FK
FOREIGN KEY (POSITION_ID) REFERENCES POSITIONS (ID);

CREATE TYPE DESK_STATUS AS ENUM('ORDERED', 'FREE');
CREATE TABLE DESKS (
  ID SERIAL PRIMARY KEY,
  DESK_TITLE TEXT NOT NULL,
  STATUS_OF_DESK DESK_STATUS DEFAULT 'FREE'
);

CREATE TABLE MENUS (
	ID SERIAL PRIMARY KEY,
	MENU_TITLE TEXT NOT NULL
);

CREATE TABLE INGREDIENTS (
  ID SERIAL PRIMARY KEY,
	INGREDIENT_TITLE TEXT NOT NULL
);

CREATE TABLE WAREHOUSE (
  ID SERIAL PRIMARY KEY,
	INGREDIENT_ID int NOT NULL,
	AMOUNT REAL
);
ALTER TABLE WAREHOUSE ADD CONSTRAINT INGREDIENT_ID_FK
FOREIGN KEY (INGREDIENT_ID) REFERENCES INGREDIENTS (ID);

CREATE TABLE CATEGORIES (
  ID SERIAL PRIMARY KEY,
	CATEGORY_TITLE TEXT NOT NULL
);

CREATE TABLE DISHES (
  ID SERIAL PRIMARY KEY,
  DISHE_TITLE TEXT NOT NULL,
  CATEGORY_ID int NOT NULL,
  PRICE REAL NOT NULL,
  WEIGHT REAL NOT NULL
);
ALTER TABLE DISHES ADD CONSTRAINT CATEGORIES_ID_FK
FOREIGN KEY (CATEGORY_ID) REFERENCES CATEGORIES (ID);

CREATE TABLE DISHES_TO_INGREDIENTS (
  DISHES_ID int NOT NULL,
  INGREDIENTS_ID int NOT NULL
);
ALTER TABLE DISHES_TO_INGREDIENTS ADD CONSTRAINT DISHES_ID_FK
FOREIGN KEY (DISHES_ID) REFERENCES DISHES (ID);
ALTER TABLE DISHES_TO_INGREDIENTS ADD CONSTRAINT INGREDIENTS_ID_FK
FOREIGN KEY (INGREDIENTS_ID) REFERENCES INGREDIENTS (ID);

CREATE TABLE MENUS_TO_DISHES (
  MENUS_ID int NOT NULL,
  DISHES_ID int NOT NULL
);
ALTER TABLE MENUS_TO_DISHES ADD CONSTRAINT MENUS_DISHES_ID_FK
FOREIGN KEY (MENUS_ID) REFERENCES MENUS (ID);
ALTER TABLE MENUS_TO_DISHES ADD CONSTRAINT DISHES_MENU_ID_FK
FOREIGN KEY (DISHES_ID) REFERENCES DISHES (ID);

CREATE TABLE ORDERS (
  ID SERIAL PRIMARY KEY,
	EMPLOYEE_ID int NOT NULL,
  DESK_ID int NOT NULL,
  ORDER_DATE TIMESTAMP NOT NULL
);
ALTER TABLE ORDERS ADD CONSTRAINT ORDERS_EMPLOYEE_ID_FK
FOREIGN KEY (EMPLOYEE_ID) REFERENCES EMPLOYEES (ID);
ALTER TABLE ORDERS ADD CONSTRAINT ORDERS_DESK_ID_FK
FOREIGN KEY (DESK_ID) REFERENCES DESKS (ID);

CREATE TABLE DISHES_TO_ORDERS (
  DISHES_ID int NOT NULL,
  ORDER_ID int NOT NULL
);
ALTER TABLE DISHES_TO_ORDERS ADD CONSTRAINT DISHES_ORDER_ID_FK
FOREIGN KEY (DISHES_ID) REFERENCES DISHES (ID);
ALTER TABLE DISHES_TO_ORDERS ADD CONSTRAINT ORDER_DISHES_ID_FK
FOREIGN KEY (ORDER_ID) REFERENCES ORDERS (ID);

CREATE TABLE DISHES_PREPARATION (
  ID SERIAL PRIMARY KEY,
  DISHES_ID int NOT NULL,
  EMPLOYEE_ID int NOT NULL,
  ORDER_ID int NOT NULL,
  DATE_PREPARATIONS TEXT NOT NULL
);
ALTER TABLE DISHES_PREPARATION ADD CONSTRAINT DISHES_PREPARATION_DISHES_ID_FK
FOREIGN KEY (DISHES_ID) REFERENCES DISHES (ID);
ALTER TABLE DISHES_PREPARATION ADD CONSTRAINT DISHES_PREPARATION_EMPLOYEE_ID_FK
FOREIGN KEY (EMPLOYEE_ID) REFERENCES EMPLOYEES (ID);
ALTER TABLE DISHES_PREPARATION ADD CONSTRAINT DISHES_PREPARATION_ORDER_ID_FK
FOREIGN KEY (ORDER_ID) REFERENCES ORDERS (ID);
